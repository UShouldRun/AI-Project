# create_ds.py Documentation

Generates a dataset of self-play Connect4 games using MCTS and saves it to a CSV file.

## Overview

The `create_ds.py` script automates the process of creating a training dataset for Connect4. It uses the Monte Carlo Tree Search (MCTS) algorithm to simulate games played by an AI against itself. The generated game data, consisting of board states, actions taken, and the final game result, is then saved in a CSV format. This dataset can be used to train machine learning models to play Connect4.

## Functions

### `progress_print(iteration: int, total_items: int) -> None`

Displays a progress bar in the console during the dataset generation process.

-   **iteration**: The current iteration number.
-   **total_items**: The total number of items to process.

### `async def generate_ds(s_rollout: int, dt_size: int) -> np.array`

Generates a dataset of self-play Connect4 games using MCTS.

-   **s\_rollout**: The number of MCTS simulations to perform for each move.
-   **dt\_size**: The total number of games to generate.

**Returns**:
A NumPy array of length `dt_size`, where each element is a dictionary representing a single game. The dictionary has keys `1` and `2` (for each player), and each value is a tuple containing:
    -   A NumPy array of shape `(n_moves, 2)` (dtype=object) where each row contains:
        -   The `Connect4Board` state before the move.
        -   The `action` (column index) taken.
    -   The `result` of the game for that player: `0` (lose), `1` (draw), or `2` (win).

### `create_csv(games: np.array, filename: str) -> None`

Saves the generated game data to a CSV file. Each row in the CSV represents a single move made during a game.

-   **games**: The NumPy array of game data generated by `generate_ds`.
-   **filename**: The name of the CSV file to create.

The CSV file has the following columns:
-   `game_id`: The index of the game in the dataset.
-   `player`: The player who made the move (1 or 2).
-   `board1`: The integer representation of player 1's bitboard.
-   `board2`: The integer representation of player 2's bitboard.
-   `action`: The column index (0-6) where the piece was played.
-   `result`: The final result of the game for the player associated with that move (0: lose, 1: draw, 2: win).

### `async def main()`

The main function that parses command-line arguments, generates the dataset, and saves it to a CSV file.

## Usage

The script is executed from the command line with three arguments:

```bash
python create_ds.py <filename.csv: str> <s_rollout: int> <dt_size: int>
